# 要解决的问题

- 场景一：

已知：初始的 position x0，任意时刻的速度
求：某个时间刻的 position

- 场景二：

已知：初始的 position X0，速度场，即在任意 position 上的速度 [06：40]  
求：某时刻的 position

# 欧拉方法

\\[
x^{t+\delta t} = x^t + \delta t \dot x^t    
\\]

\\[
\dot x^{t+\delta t} = \dot x^t + \delta t \ddot x^t
\\]

连续问题离散化，这种思想在课程中大量运用  
[?]为什么有第二个公式？如果是问题一，\\(\dot x^t\\)已知。如果是问题二，\\(\dot x^t\\)跟\\(x^t\\)有关，应该用不到\\(\ddot x^t\\)。而且\\(\ddot x^t\\)未知，用到了也没法算  
特点：  
- 简单，直观迭代。
- 不稳定
- \\(\delta t\\)越小越精确
- [1：18：54] 不稳定性与步长无关，

用数值方法解微分方程的共性问题：
1. 误差 VS 精度
2. 不稳定， **divergence**

我的思考：  
有点像花书里的"病态问题'。输入的微小改变导到输出的巨大变化。  
也可以理解为函数在不同方向上的敏感度差着很大.

## 对抗欧拉方法的不稳定性

### 中点法 Midpoint Method

1. 当前点为\\(x^t\\)，用欧拉方法计算\\(x^{t+\delta t}\\)
2. 取中点\\(x_{mid} = x^t + x^{t+\delta t}\\)
3. 取电点位置的速度\\(\dot x_{mid}\\)
4. 把\\(\dot x_{mid}\\)当成\\(\dot x^t\\),再算一次\\(x^{t+\delta t}\\)，

直观上看，很奇怪中点法更准确。展开后发现，中点法比原方法多了二次项函\\(\frac{(\delta t)^2}{2}\\)

### Adaptive Step Size

1. 定义初始的\\(delta t\\)为\\(delta_0\\)
2. 用欧拉方法计算\\(x^{t+\delta_0}\\)。←用\\(delta_0\\)算一遍欧拉方法
3. 用欧拉方计算\\(x^{t+2*\frac{1}{2}\delta_0}\\)。 ←用\\(2*\frac{1}{2}delta_0\\)算两遍欧拉方法
4. 如果\\(x^{t+\delta_0}\\)与\\(x^{t+2*\frac{1}{2}\delta_0}\\)差别比较大，取后者，且将\\(delta_0\\)更新为\\(\frac{1}{2}delta_0\\)。

### Implicit （隐式的） Euler Method

原问题：已知\\(x^t\\)和\\(\dot x^t\\)，求\\(x^{t+\delta t}\\)   
转化为新问题：\\(x^t\\)和\\(\dot x^{t+\delta t}\\)，求\\(x^{t+\delta t}\\)  

部分已知，部分未知，变成了一个优化问题。

我的思考：  
显式和隐式，有种FK和IK的感觉。利用被依顿现计算依赖项，用数学公式。利用依顿现计算被依赖项，用优化问题，近似

优点：稳定。

## 衡量欧拉方法的稳定性

指标：局部截断误差、全局积累误差

计算误差与\\(\delta t\\)的关系，例如 Implicit 方法为O(h)，即1阶。阶数越高越好。

### Runge-kutta 方法

欧拉方法用于解线性ODE（常微分方程）
Rk 4. 4代表4阶

已知：  

\\[
\frac{dy}{dt} = f(t, y)
\\]

\\[
y(t_0) = y_0
\\]

RK 4解法:

\\[
y_{n+1} = y_n + \frac{1}{6}h(k_1 + 2k_2 + 2k_3 + k_4)    
\\]

说明： 
这个公式里的h就是\\(\Delta t\\)  
()中的四个加法项是基于中点法的中间结果，系数是精心设计的  

\\[
t_{n+1} = t_n + h
\\]

如果说中点法是泰勒展开的即视感，那么这里的公式是对泰勒展开更精确的模拟

问：为什么说RK系列擅长非线性呢？都是以欧拉方法为基础，在哪里引入的非线性的设计？
答：1阶是处理线性问题，高于1阶才能处理非线性。理解类似泰勒公式的近似截断。

### Position Based / Verlet 积分

原理：只是通过调整位置使得能够满足某些限制，简化化弹簧的物理推导过程
优点：快、简单
缺点：不是基于真实的物理过程可自绘有错误

------------------------------

> 本文出自CaterpillarStudyGroup，转载请注明出处。
>
> https://caterpillarstudygroup.github.io/GAMES101_mdbook/